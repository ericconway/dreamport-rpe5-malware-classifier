{
    "filepath": "/home/chris/data/rpe005/malware_samples_exercise/20190522_110020_rpe005_malware_alert/modal[1].js",
    "fileinfo": {
        "labels": {
            "family": "bad_sample_6",
            "software": "test_file"
        },
        "md5": "7119eff8dc6d37a4bbd7c2605fdca2d5",
        "type": "ASCII text",
        "clamav": "OK",
        "blobs": "Extracted 2 blobs (2 ASCII)"
    },
    "plugins": [
        {
            "plugin": "extractors.disassembly",
            "version": "0.1",
            "results": {}
        },
        {
            "plugin": "extractors.strings",
            "version": "0.1",
            "results": {
                "/*-------------------------------------------------------------------": 1,
                "Name: Single Page PDC - Modal JS": 1,
                "$Author: skattima $": 1,
                "$DateTime: 2013/09/18 09:32:01 $": 1,
                "$Revision: #4 $": 1,
                "-------------------------------------------------------------------*/": 1,
                "/*-- Code based on the WCMS Modal implementation --*/": 1,
                "handleModal = function(config) {": 1,
                "var currentWindowSize =": 1,
                "width: 0,": 1,
                "height: 0": 1,
                "function handleWindowResize(event) {": 1,
                "var dimension = event.data.dimension,": 1,
                "newsize = $(window)[dimension]()": 1,
                "if (!dimension) {": 1,
                "return": 4,
                "if (newsize == currentWindowSize[dimension]) {": 1,
                "currentWindowSize[dimension] = newsize": 1,
                "var handler = event.data.handler": 3,
                "if (!handler) {": 1,
                "event.data.handler()": 1,
                "function getValidDimension(dim, buffer) {": 1,
                "var out = parseInt(dim),": 1,
                "finalDim = ''": 1,
                "if ($.browser.msie && parseFloat($.browser.version) >= 7.0 && parseFloat($.browser.version) < 8.0) {": 5,
                "// For some reason IE7 always does better calculating the height and width itself": 1,
                "finalDim = \"auto\"": 2,
                "} else {": 8,
                "if (isNaN(out)) {": 1,
                "finalDim = (out + parseInt(buffer))": 1,
                "return finalDim": 1,
                "function createOpenModalHandler(config)": 1,
                "var modal = $(\"#\"+config.target),": 1,
                "marginWidth = 40,": 1,
                "marginHeight = 62": 1,
                "if (config.external == true ) {": 1,
                "modal.html('<iframe style=\"border: 0": 1,
                "\" frameborder=\"0\" src=\"' + config.href + '\" width=\"100%\" height=\"99%\">": 1,
                "</iframe>').dialog({": 1,
                "modal: true,": 2,
                "title: config.title || \"\",": 2,
                "height: config.height,": 1,
                "width: config.width,": 1,
                "autoOpen: false,": 2,
                "resizable: false,": 2,
                "draggable: false,": 2,
                "closeOnClick: true,": 2,
                "open: function() {": 2,
                "// Adjust the width for IE8 with 'auto' config": 2,
                "if ($.browser.msie && parseFloat($.browser.version) >= 8.0 && isNaN(config.height))": 2,
                "modal.dialog('option','width',(modal.innerWidth() - 20))": 2,
                "modalRelocate()": 2,
                "// Adjust the title bar for IE7": 2,
                "$('.ui-dialog-titlebar').css('width', (modal.parent().innerWidth() - marginWidth))": 2,
                "// allow closing by clicking outside the modal window": 2,
                "if (modal.dialog( \"option\", \"closeOnClick\" )) {": 4,
                "$(\".ui-widget-overlay\").bind('click', function() {": 2,
                "modal.dialog('close')": 2,
                "close: function() {": 2,
                "// Unbind scrolling and window resizing": 1,
                "$(window).unbind(\"resize\", handleWindowResize)": 1,
                "// Check for browser scroll events and relocate the modal.": 1,
                "if ($.browser.msie && parseFloat($.browser.version) <= 7.0)": 1,
                "// Skip scroll events for IE6 & 7": 1,
                "$(window).unbind(\"scroll\", modalRelocate)": 1,
                "// Reset titlebar dimensions for IE7": 2,
                "$('.ui-dialog-titlebar').css('width', '')": 2,
                "// Unbind closing by clicking outside the modal window": 2,
                "$(\".ui-widget-overlay\").unbind('click')": 2,
                "// empty() and destroy() are kind of broken until jquery 1.8.5": 2,
                "modal.remove()": 2,
                "modal.dialog({": 1,
                "height: getValidDimension(config.height, marginHeight),": 1,
                "width: getValidDimension(config.width, marginWidth),": 1,
                "function modalRelocate() {": 1,
                "modal.dialog('option','position',['center','center'])": 1,
                "function modalLaunch(combinedXObjects,combinedYObjects) {": 1,
                "var modalX = null,": 1,
                "modalY = null": 1,
                "if (combinedXObjects != null) {": 1,
                "modalX = ( $(window).width() - combinedXObjects ) / 2": 1,
                "modal.dialog('option','width',combinedXObjects)": 2,
                "if (combinedYObjects != null) {": 1,
                "modalY = ( $(window).height() - combinedYObjects ) / 2": 1,
                "modal.dialog('option','height',combinedYObjects)": 2,
                "if (modalY != null && modalX != null) {": 1,
                "modal.dialog('option','position',[modalX,modalY])": 1,
                "modal.dialog('open')": 7,
                "function openModal() {": 1,
                "if ( config.external == false ) {": 1,
                "modal.load(config.href, function(response, status) {": 1,
                "var external = config.external": 1,
                "if (status == \"error\" && external == \"undefined\") {": 1,
                "return true": 1,
                "var browserIE = $.browser.msie,": 1,
                "browserVersion = parseFloat($.browser.version)": 1,
                "if (browserIE && browserVersion >= 7 && browserVersion < 8) {": 1,
                "$(\"#\"+config.target).css('width',config.width)": 1,
                "if (browserIE && browserVersion < 7){": 1,
                "if ($(\"#\"+config.target + \" img\").length != 0) {": 1,
                "var newImg = new Image(),": 1,
                "combinedXObjects = (newImg.width + marginWidth) - 20,": 1,
                "combinedYObjects = newImg.height + marginHeight + 11": 1,
                "newImg.src = modal.find(\"img\").attr('src')": 1,
                "} else if ($(\"#\"+config.target + \" object\").length != 0) {": 1,
                "combinedXObjects = (parseInt($(\"#\"+config.target + \" object\").attr('width')) + marginWidth) - 20": 1,
                "combinedYObjects = parseInt($(\"#\"+config.target + \" object\").attr('height')) + marginHeight + 8": 1,
                "modalLaunch(combinedXObjects,combinedYObjects)": 1,
                "var modalWidth = config.width,": 1,
                "modalHeight = \"auto\"": 1,
                "modal.dialog('option','width',modalWidth)": 1,
                "modal.dialog('option','height',modalHeight)": 1,
                "return false": 4,
                "openModal()": 1,
                "//TOP LEVEL ON LOAD ACTIONS EVERYTHING BEFORE THIS ARE METHODS IN THE MODAL CLOSURE": 1,
                "if (config === undefined) {": 1,
                "currentWindowSize.width = $(window).width()": 1,
                "if (currentWindowSize.width > (parseInt(config.width) || 0)) {": 1,
                "// get modal element target from config": 1,
                "var mid = config.target,": 1,
                "e = $(\"#\"+mid)": 1,
                "// create a modal element if none found": 1,
                "if (e[0] == null) {": 1,
                "$('<div/>', {id: mid}).appendTo('body')": 1,
                "createOpenModalHandler(config)": 1,
                "word: single": 3,
                "word: author": 3,
                "word: skattima": 3,
                "word: datetime": 3,
                "word: revision": 3,
                "word: implementation": 3,
                "word: handlemodal": 3,
                "word: function": 32,
                "word: config": 71,
                "word: currentwindowsize": 13,
                "word: height": 35,
                "word: handlewindowresize": 5,
                "word: dimension": 18,
                "word: newsize": 9,
                "word: window": 23,
                "word: return": 19,
                "word: handler": 12,
                "word: getvaliddimension": 7,
                "word: buffer": 5,
                "word: parseint": 12,
                "word: finaldim": 11,
                "word: browser": 61,
                "word: parsefloat": 37,
                "word: version": 37,
                "word: reason": 2,
                "word: always": 2,
                "word: better": 2,
                "word: calculating": 2,
                "word: itself": 2,
                "word: createopenmodalhandler": 5,
                "word: target": 18,
                "word: marginwidth": 12,
                "word: marginheight": 8,
                "word: external": 10,
                "word: iframe": 4,
                "word: border": 2,
                "word: frameborder": 2,
                "word: dialog": 57,
                "word: autoopen": 5,
                "word: resizable": 5,
                "word: draggable": 5,
                "word: closeonclick": 13,
                "word: adjust": 11,
                "word: option": 30,
                "word: innerwidth": 10,
                "word: modalrelocate": 10,
                "word: titlebar": 12,
                "word: parent": 4,
                "word: closing": 8,
                "word: clicking": 8,
                "word: outside": 8,
                "word: widget": 8,
                "word: overlay": 8,
                "word: unbind": 14,
                "word: scrolling": 2,
                "word: resizing": 2,
                "word: resize": 2,
                "word: scroll": 6,
                "word: events": 4,
                "word: relocate": 2,
                "word: dimensions": 4,
                "word: destroy": 4,
                "word: broken": 4,
                "word: jquery": 4,
                "word: remove": 4,
                "word: position": 4,
                "word: center": 4,
                "word: modallaunch": 4,
                "word: combinedxobjects": 16,
                "word: combinedyobjects": 16,
                "word: modalx": 8,
                "word: modaly": 8,
                "word: openmodal": 4,
                "word: response": 2,
                "word: status": 4,
                "word: undefined": 4,
                "word: browserie": 6,
                "word: browserversion": 9,
                "word: length": 4,
                "word: newimg": 8,
                "word: object": 6,
                "word: modalwidth": 4,
                "word: modalheight": 4,
                "word: actions": 2,
                "word: everything": 2,
                "word: before": 2,
                "word: methods": 2,
                "word: closure": 2,
                "word: element": 6,
                "word: create": 3,
                "word: appendto": 3,
                "special: 2013/09/18": 3,
                "special: 09:32:01": 3,
                "special: event.data.dimension": 3,
                "special: event.data.handler": 6,
                "special: browser.msie": 22,
                "special: browser.version": 37,
                "special: 7.0": 17,
                "special: 8.0": 16,
                "special: config.target": 15,
                "special: config.external": 6,
                "special: modal.html": 2,
                "special: config.href": 4,
                "special: config.title": 5,
                "special: config.height": 11,
                "special: config.width": 12,
                "special: modal.dialog": 46,
                "special: modal.innerWidth": 2,
                "special: modal.parent": 4,
                "special: ui-dialog-titlebar": 8,
                "special: ui-widget-overlay": 8,
                "special: 1.8.5": 4,
                "special: modal.remove": 4,
                "special: modal.load": 2,
                "special: newImg.width": 1,
                "special: newImg.height": 1,
                "special: newImg.src": 1,
                "special: modal.find": 2,
                "special: currentWindowSize.width": 2,
                "/*------------------------------------------------------------------- name: single page pdc - modal js $author: skattima $ $datetime: 2013/09/18 09:32:01 $ $revision: #4 $ -------------------------------------------------------------------*/ /*-- code based on the wcms modal implementation --*/ handlemodal = function(config) { var currentwindowsize = { width: 0, height: 0 }": 2,
                "function handlewindowresize(event) { var dimension = event.data.dimension, newsize = $(window)[dimension]()": 2,
                "if (!dimension) { return": 2,
                "} if (newsize == currentwindowsize[dimension]) { return": 2,
                "} currentwindowsize[dimension] = newsize": 2,
                "if (!handler) { return": 2,
                "} event.data.handler()": 2,
                "} function getvaliddimension(dim, buffer) { var out = parseint(dim), finaldim = ''": 2,
                "if ($.browser.msie parsefloat($.browser.version) >= 7.0 parsefloat($.browser.version) ').dialog({ modal: true, title: config.title || \"\", height: config.height, width: config.width, autoopen: false, resizable: false, draggable: false, closeonclick: true, open: function() { // adjust the width for ie8 with 'auto' config if ($.browser.msie parsefloat($.browser.version) >= 8.0 isnan(config.height)) { modal.dialog('option','width',(modal.innerwidth() - 20))": 1,
                "modalrelocate()": 4,
                "} // adjust the title bar for ie7 if ($.browser.msie parsefloat($.browser.version) >= 7.0 parsefloat($.browser.version) = 7.0 parsefloat($.browser.version) = 8.0 isnan(config.height)) { modal.dialog('option','width',(modal.innerwidth() - 20))": 1,
                "} // adjust the title bar for ie7 if ($.browser.msie parsefloat($.browser.version) >= 7.0 parsefloat($.browser.version) = 7.0 parsefloat($.browser.version) = 7 browserversion (parseint(config.width) || 0)) { // get modal element target from config var mid = config.target, e = $(\"#\"+mid)": 1,
                "// create a modal element if none found if (e[0] == null) { $(' ', {id: mid}).appendto('body')": 1,
                "} createopenmodalhandler(config)": 2,
                "special: modal.innerwidth": 4,
                "if ($.browser.msie && parsefloat($.browser.version) >= 7.0 && parsefloat($.browser.version) <8.0) { // for some reason ie7 always does better calculating the height and width itself finaldim=\"auto\"": 1,
                "} else { if (isnan(out)) { finaldim=\"auto\"": 1,
                "} else { finaldim=(out + parseint(buffer))": 1,
                "} } return finaldim": 1,
                "} function createopenmodalhandler(config) { var modal=$(\"#\"+config.target), marginwidth=40, marginheight=62": 1,
                "if (config.external== true ) { modal.html('<iframe style=\"border: 0": 1,
                "\" frameborder=\"0\" src=\"\" + config.href + '\" width=\"100%\" height=\"99%\">": 1,
                "</iframe>').dialog({ modal: true, title: config.title || \"\", height: config.height, width: config.width, autoopen: false, resizable: false, draggable: false, closeonclick: true, open: function() { // adjust the width for ie8 with 'auto' config if ($.browser.msie && parsefloat($.browser.version) >= 8.0 && isnan(config.height)) { modal.dialog('option','width',(modal.innerwidth() - 20))": 1,
                "} // adjust the title bar for ie7 if ($.browser.msie && parsefloat($.browser.version) >= 7.0 && parsefloat($.browser.version) <8.0) { $('.ui-dialog-titlebar').css('width', (modal.parent().innerwidth() - marginwidth))": 2,
                "} // allow closing by clicking outside the modal window if (modal.dialog( \"option\", \"closeonclick\" )) { $(\".ui-widget-overlay\").bind('click', function() { modal.dialog('close')": 2,
                "} }, close: function() { // unbind scrolling and window resizing $(window).unbind(\"resize\", handlewindowresize)": 1,
                "// check for browser scroll events and relocate the modal. if ($.browser.msie && parsefloat($.browser.version) <=7.0) { // skip scroll events for ie6 & 7 } else { $(window).unbind(\"scroll\", modalrelocate)": 1,
                "} // reset titlebar dimensions for ie7 if ($.browser.msie && parsefloat($.browser.version)>= 7.0 && parsefloat($.browser.version) <8.0) { $('.ui-dialog-titlebar').css('width', '')": 1,
                "} // unbind closing by clicking outside the modal window if (modal.dialog( \"option\", \"closeonclick\" )) { $(\".ui-widget-overlay\").unbind('click')": 2,
                "} // empty() and destroy() are kind of broken until jquery 1.8.5 modal.remove()": 2,
                "} else { modal.dialog({ modal: true, title: config.title || \"\", height: getvaliddimension(config.height, marginheight), width: getvaliddimension(config.width, marginwidth), autoopen: false, resizable: false, draggable: false, closeonclick: true, open: function() { // adjust the width for ie8 with 'auto' config if ($.browser.msie && parsefloat($.browser.version)>= 8.0 && isnan(config.height)) { modal.dialog('option','width',(modal.innerwidth() - 20))": 1,
                "} }, close: function() { // reset titlebar dimensions for ie7 if ($.browser.msie && parsefloat($.browser.version)>= 7.0 && parsefloat($.browser.version) <8.0) { $('.ui-dialog-titlebar').css('width', '')": 1,
                "} function modalrelocate() { modal.dialog('option','position',['center','center'])": 1,
                "} function modallaunch(combinedxobjects,combinedyobjects) { var modalx=null, modaly=null": 1,
                "if (combinedxobjects !=null) { modalx=( $(window).width() - combinedxobjects ) / 2": 1,
                "modal.dialog('option','width',combinedxobjects)": 2,
                "} if (combinedyobjects !=null) { modaly=( $(window).height() - combinedyobjects ) / 2": 1,
                "modal.dialog('option','height',combinedyobjects)": 2,
                "} if (modaly !=null && modalx !=null) { modal.dialog('option','position',[modalx,modaly])": 1,
                "} modal.dialog('open')": 1,
                "} function openmodal() { if ( config.external== false ) { modal.load(config.href, function(response, status) { var external=config.external": 1,
                "if (status== \"error\" && external== \"undefined\") { return true": 1,
                "} else { var browserie=$.browser.msie, browserversion=parsefloat($.browser.version)": 1,
                "if (browserie && browserversion>= 7 && browserversion <8) { $(\"#\"+config.target).css('width',config.width)": 1,
                "} if (browserie && browserversion < 7){ if ($(\"#\"+config.target + \" img\").length !=0) { var newimg=new image(), combinedxobjects=(newimg.width + marginwidth) - 20, combinedyobjects=newimg.height + marginheight + 11": 1,
                "newimg.src=modal.find(\"img\").attr(\"src\")": 1,
                "} else if ($(\"#\"+config.target + \" object\").length !=0) { combinedxobjects=(parseint($(\"#\"+config.target + \" object\").attr('width')) + marginwidth) - 20": 1,
                "combinedyobjects=parseint($(\"#\"+config.target + \" object\").attr('height')) + marginheight + 8": 1,
                "modallaunch(combinedxobjects,combinedyobjects)": 1,
                "} else { var modalwidth=config.width, modalheight=\"auto\"": 1,
                "modal.dialog('option','width',modalwidth)": 1,
                "modal.dialog('option','height',modalheight)": 1,
                "} } else { modal.dialog('open')": 1,
                "} } })": 1,
                "} else { modal.dialog('open')": 1,
                "} } openmodal()": 1,
                "} //top level on load actions everything before this are methods in the modal closure if (config=== undefined) { return": 1,
                "} currentwindowsize.width=$(window).width()": 1,
                "if (currentwindowsize.width>(parseint(config.width) || 0)) { // get modal element target from config var mid = config.target, e = $(\"#\"+mid)": 1,
                "// create a modal element if none found if (e[0] == null) { $('<div/>', {id: mid}).appendto('body')": 1,
                "special: newimg.width": 1,
                "special: newimg.height": 1,
                "special: newimg.src": 1,
                "special: currentwindowsize.width": 2
            }
        },
        {
            "plugin": "extractors.meta",
            "version": "0.1",
            "results": {
                "clamav: Cannot dlopen libclamunrar_iface: file not found - unrar support unavailable": 1,
                "clamav: cli_loadftm: File type signature for Microsoft Windows Shortcut File not loaded (required f-level: 1??)": 1,
                "clamav: [Bytecode JIT]; emitted ELF64-x86-64 <in-memory object> of 7?? bytes": 1,
                "clamav: bytecode self test running": 1,
                "clamav: Bytecode 4?????????: executing in JIT mode": 1,
                "clamav: bytecode finished in 1 us": 1,
                "clamav: bytecode self test succeeded": 1,
                "clamav: [Bytecode JIT]; emitted ELF64-x86-64 <in-memory object> of 1????? bytes": 1,
                "clamav: Bytecode: 94 bytecode prepared with JIT": 1,
                "clamav: Recognized ASCII text": 1,
                "clamav: Matched signature for file type HTML data at 1???": 1,
                "clamav: in cli_scanhtml()": 1,
                "clamav: cli_magic_scandesc: returning 0  at line 2???": 1,
                "clamav: malware family: OK": 1,
                "clamav: OK": 1,
                "clamav: Scanned files: 1": 1,
                "clamav: Infected files: 0": 1,
                "clamav: extracted blobs": 1,
                "clamav: extracted 1 blobs": 1,
                "clamav: blob size: 4???": 1,
                "clamav: Cannot dlopen libclamunrar_iface: file not found - unrar support unavailable;clamav: cli_loadftm: File type signature for Microsoft Windows Shortcut File not loaded (required f-level: 1??)": 1,
                "clamav: cli_loadftm: File type signature for Microsoft Windows Shortcut File not loaded (required f-level: 1??);clamav: [Bytecode JIT]; emitted ELF64-x86-64 <in-memory object> of 7?? bytes": 1,
                "clamav: [Bytecode JIT]; emitted ELF64-x86-64 <in-memory object> of 7?? bytes;clamav: bytecode self test running": 1,
                "clamav: bytecode self test running;clamav: Bytecode 4?????????: executing in JIT mode": 1,
                "clamav: Bytecode 4?????????: executing in JIT mode;clamav: bytecode finished in 1 us": 1,
                "clamav: bytecode finished in 1 us;clamav: bytecode self test succeeded": 1,
                "clamav: bytecode self test succeeded;clamav: [Bytecode JIT]; emitted ELF64-x86-64 <in-memory object> of 1????? bytes": 1,
                "clamav: [Bytecode JIT]; emitted ELF64-x86-64 <in-memory object> of 1????? bytes;clamav: Bytecode: 94 bytecode prepared with JIT": 1,
                "clamav: Bytecode: 94 bytecode prepared with JIT;clamav: Recognized ASCII text": 1,
                "clamav: Recognized ASCII text;clamav: Matched signature for file type HTML data at 1???": 1,
                "clamav: Matched signature for file type HTML data at 1???;clamav: in cli_scanhtml()": 1,
                "clamav: in cli_scanhtml();clamav: cli_magic_scandesc: returning 0  at line 2???": 1,
                "clamav: cli_magic_scandesc: returning 0  at line 2???;clamav: malware family: OK": 1,
                "clamav: malware family: OK;clamav: OK": 1,
                "clamav: OK;clamav: Scanned files: 1": 1,
                "clamav: Scanned files: 1;clamav: Infected files: 0": 1,
                "clamav: Infected files: 0;clamav: extracted blobs": 1,
                "clamav: extracted blobs;clamav: extracted 1 blobs": 1,
                "clamav: extracted 1 blobs;clamav: blob size: 4???": 1,
                "File type: ASCII text": 1,
                "File type segment: ASCII text": 1,
                "File type word: ASCII": 1,
                "File type word: text": 1,
                "Extracted blob: ASCII text, with very long lines, with no line terminators": 2,
                "blob file types: ASCII": 1
            }
        }
    ]
}