{
    "filepath": "/home/chris/data/rpe005/malware_samples_exercise/20190522_110020_rpe005_malware_alert/visit[2].js",
    "fileinfo": {
        "labels": {
            "family": "bad_sample_6",
            "software": "test_file"
        },
        "md5": "c9b3720b2d2303794437e8dc33c553fc",
        "type": "ASCII text, with very long lines, with CRLF, LF line terminators",
        "clamav": "OK",
        "blobs": "Extracted 1 blobs (1 ASCII)"
    },
    "plugins": [
        {
            "plugin": "extractors.disassembly",
            "version": "0.1",
            "results": {}
        },
        {
            "plugin": "extractors.strings",
            "version": "0.1",
            "results": {
                "try{var dv_win = window._dv_win || window.parent._dv_win": 2,
                "dv_win['dvCallback_1558529198752540']($dv,window,'2d65a8de43154fa8a88ea865c9fff4b5','tps10264.doubleverify.com')": 1,
                "}catch(e){try{var image=window.document.createElement('img')": 1,
                "image.src=window.location.protocol+'//tps30.doubleverify.com/visit.jpg?ctx=818052&cmp=1619415&dvtagver=6.1.src&dvp_cbError='+encodeURIComponent(e.message)}catch(e){}}$dv.pubSub.subscribe('ImpressionServed', $uid, 'RTN_LatencyTemp', function () {try {var beforeVisitCall = ''": 1,
                "var templateStartTime = parent.getCurrentTime()": 1,
                "var dv_win = parent.window._dv_win": 2,
                "if (dv_win && dv_win.t2tTimestampData) {if (dv_win.t2tTimestampData.length >= 2) {beforeVisitCall = dv_win.t2tTimestampData[1].beforeVisitCall": 1,
                "}}var latency = 0": 2,
                "if (beforeVisitCall != '' && templateStartTime != '') {latency = templateStartTime - beforeVisitCall": 1,
                "}if(latency > 1000 && latency < 90000) {$dv.registerEventCall($uid, { dvp_ltncy: latency })": 1,
                "}} catch (e) {}": 2,
                "$dv.pubSub.subscribe ('ImpressionServed', $uid, 'SendAdEntitiesForBSBAConsolidation', function() {": 1,
                "'use strict'": 1,
                "var stringifyFunc = null": 1,
                "if(window.JSON){": 1,
                "stringifyFunc = window.JSON.stringify": 1,
                "} else {": 1,
                "if(window.parent && window.parent.JSON){": 1,
                "stringifyFunc = window.parent.JSON.stringify": 1,
                "if(!stringifyFunc){": 1,
                "return": 5,
                "var targetWin": 1,
                "var tag = $dv.tags[$uid]": 2,
                "var bsmsg = {": 1,
                "action : 'notifyBrandShieldAdEntityInformation',": 1,
                "bsAdEntityInformation : {": 1,
                "comparisonItems : [{name : 'cmp', value : 3779693},{name : 'plmt', value : 3779742}], verboseReporting : false  }": 1,
                "var bsstring = stringifyFunc(bsmsg)": 1,
                "var findAndSend = function(){": 1,
                "if(!targetWin) {": 1,
                "if (tag) {": 1,
                "targetWin = tag.t2tIframeWindow": 1,
                "if (!targetWin) {": 1,
                "var t2tIframeId = tag.t2tIframeId": 1,
                "//get t2t window and post the AdEntities to it.": 1,
                "if (t2tIframeId) {": 1,
                "var iFrame = window.parent.getElementById(t2tIframeId)": 1,
                "if (iFrame) {": 1,
                "targetWin = iFrame.contentWindow": 1,
                "if(targetWin){": 1,
                "targetWin.postMessage(bsstring, '*')": 1,
                "findAndSend()": 1,
                "setTimeout(findAndSend, 100)": 1,
                "setTimeout(findAndSend, 500)": 1,
                "$dv.pubSub.subscribe('ImpressionServed', $uid, 'RTN_FBITemp', function () {try {": 1,
                "window.isFirstCall = true": 1,
                "window.EtVal = ''": 1,
                "window.EtnVal = ''": 1,
                "window.EtRandVal = ''": 1,
                "window.AddEtCall = function (id) {": 1,
                "var queryUrl = $dv.tags[$uid].dv_protocol + '/' + '/tps30.doubleverify.com/query.js?ctx=818052&cmp=1239517532'": 1,
                "var scriptElem = document.createElement('script')": 1,
                "scriptElem.id = id": 1,
                "scriptElem.type = 'text/javascript'": 1,
                "scriptElem.src = queryUrl": 1,
                "document.body.insertBefore(scriptElem, document.body.firstChild)": 1,
                "window.eCallback = function(et, isEtNew, etRand) {": 1,
                "if (window.isFirstCall) {": 1,
                "window.EtVal = et": 1,
                "window.EtnVal = isEtNew": 1,
                "window.EtRandVal = etRand": 1,
                "window.isFirstCall = false": 1,
                "setTimeout(function() {window.AddEtCall('dvet2')": 1,
                "}, 10)": 4,
                "if(etRand != undefined && etRand === window.EtRandVal) {": 1,
                "setTimeout(function() {window.AddEtCall('dvet' + etRand)": 1,
                "var isEtTwice = et == window.EtVal": 1,
                "$dv.registerEventCall($uid, { 'dvp_et':window.EtVal, 'dvp_etn':window.EtnVal, 'dvp_ett':(isEtTwice ? '1' : '0')})": 1,
                "window.AddEtCall('dvet1')": 1,
                "} catch (e) {}": 2,
                "var dvObj = $dv": 1,
                "function np764531(g,i){function d(){function d(){function f(b,a){b=(i?\"dvp_\":\"\")+b": 2,
                "e[b]=a}var e={},a=function(b){for(var a=[],c=0": 2,
                "c<b.length": 2,
                "c+=2)a.push(String.fromCharCode(parseInt(b.charAt(c)+b.charAt(c+1),32)))": 1,
                "return a.join(\"\")},h=window[a(\"3e313m3937313k3f3i\")]": 2,
                "h&&(a=h[a(\"3g3c313k363f3i3d\")],f(\"pltfrm\",a))": 2,
                "(function(){var a=e": 2,
                "dvObj.registerEventCall(g,a,2E3,true)})()}try{d()}catch(f){}}try{dvObj.pubSub.subscribe(dvObj==window.$dv?\"ImpressionServed\":\"BeforeDecisionRender\",g,\"np764531\",d)}catch(f){}}": 1,
                "np764531(\"2d65a8de43154fa8a88ea865c9fff4b5\",false)": 2,
                "$dv.tags[$uid].dc = $dv.tags[$uid].dc || []": 2,
                "$dv.tags[$uid].dc.push({\"rq\":{\"av\":98,\"ic\":true,\"fc\":true,\"adc\":1000,\"mla\":false,\"ldav\":30},\"rp\":{\"mt\":\"ismms\",\"pt\":\"ispmxpms\"}})": 2,
                "$dv.pubSub.subscribe('ImpressionServed', $uid, 'OperaVendorChecker', function(){var eventData = {}": 1,
                "var mraidObject = $dv.getMraid()": 1,
                "var execMrSaf = function(func) {": 1,
                "var rv": 1,
                "if (typeof func === 'function') {rv = func.call(mraidObject)}": 1,
                "}catch (e) {": 1,
                "eventData = {'dvp_operr': 1}": 1,
                "return rv": 1,
                "if(mraidObject)": 1,
                "var vendor = execMrSaf(mraidObject.getVendor)": 1,
                "var vendor_version = execMrSaf(mraidObject.getVendorVersion)": 1,
                "if(vendor != null && vendor_version != null)": 1,
                "eventData = {": 2,
                "dvp_sspv: vendor,": 1,
                "dvp_sspvv: vendor_version": 1,
                "}}catch (e){": 1,
                "dvp_operr: 2": 1,
                "}$dv.registerEventCall($uid, eventData)": 1,
                "$dv.CommonData.deviceType = 1": 1,
                "$dv.CommonData.detectedDeliveryType = 1": 1,
                "$dv.tags[$uid].deviceType = 1": 1,
                "$dv.tags[$uid].detectedDeliveryType = 1": 1,
                "try{$dv.pubSub.publish('ImpressionServed', $uid)": 1,
                "$dv.pubSub.publish('ImpressionServed', $frmId)": 1,
                "}catch(e){}": 2,
                "word: window": 66,
                "word: parent": 14,
                "word: dvcallback": 2,
                "word: doubleverify": 6,
                "word: document": 8,
                "word: createelement": 4,
                "word: location": 2,
                "word: protocol": 4,
                "word: dvtagver": 2,
                "word: cberror": 2,
                "word: encodeuricomponent": 2,
                "word: message": 2,
                "word: pubsub": 14,
                "word: subscribe": 10,
                "word: impressionserved": 14,
                "word: latencytemp": 2,
                "word: function": 34,
                "word: beforevisitcall": 10,
                "word: templatestarttime": 6,
                "word: getcurrenttime": 2,
                "word: ttimestampdata": 6,
                "word: length": 4,
                "word: latency": 10,
                "word: registereventcall": 8,
                "word: sendadentitiesforbsbaconsolidation": 2,
                "word: strict": 2,
                "word: stringifyfunc": 10,
                "word: stringify": 4,
                "word: return": 10,
                "word: targetwin": 14,
                "word: action": 2,
                "word: notifybrandshieldadentityinformation": 2,
                "word: bsadentityinformation": 2,
                "word: comparisonitems": 2,
                "word: verbosereporting": 2,
                "word: bsstring": 4,
                "word: findandsend": 8,
                "word: tiframewindow": 2,
                "word: tiframeid": 8,
                "word: adentities": 2,
                "word: iframe": 6,
                "word: getelementbyid": 2,
                "word: contentwindow": 2,
                "word: postmessage": 2,
                "word: settimeout": 8,
                "word: fbitemp": 2,
                "word: isfirstcall": 6,
                "word: etnval": 6,
                "word: etrandval": 6,
                "word: addetcall": 8,
                "word: queryurl": 4,
                "word: scriptelem": 10,
                "word: script": 2,
                "word: javascript": 2,
                "word: insertbefore": 2,
                "word: firstchild": 2,
                "word: ecallback": 2,
                "word: isetnew": 4,
                "word: etrand": 10,
                "word: undefined": 2,
                "word: isettwice": 4,
                "word: string": 2,
                "word: fromcharcode": 2,
                "word: parseint": 2,
                "word: charat": 4,
                "word: pltfrm": 2,
                "word: beforedecisionrender": 2,
                "word: ispmxpms": 2,
                "word: operavendorchecker": 2,
                "word: eventdata": 10,
                "word: mraidobject": 10,
                "word: getmraid": 2,
                "word: execmrsaf": 6,
                "word: typeof": 2,
                "word: vendor": 12,
                "word: getvendor": 2,
                "word: version": 6,
                "word: getvendorversion": 2,
                "word: commondata": 4,
                "word: devicetype": 4,
                "word: detecteddeliverytype": 4,
                "word: publish": 4,
                "special: window.parent": 4,
                "special: tps10264.doubleverify.com": 2,
                "special: window.document.createElement": 1,
                "special: image.src": 2,
                "special: window.location.protocol": 2,
                "special: tps30.doubleverify.com": 4,
                "special: visit.jpg": 2,
                "special: 6.1.src": 2,
                "special: e.message": 2,
                "special: dv.pubSub.subscribe": 4,
                "special: parent.getCurrentTime": 1,
                "special: parent.window": 2,
                "special: win.t2tTimestampData": 2,
                "special: win.t2tTimestampData.length": 1,
                "special: dv.registerEventCall": 3,
                "special: com/visit": 2,
                "special: window.JSON": 1,
                "special: window.JSON.stringify": 1,
                "special: window.parent.JSON": 1,
                "special: window.parent.JSON.stringify": 1,
                "special: dv.tags": 14,
                "special: tag.t2tIframeWindow": 1,
                "special: tag.t2tIframeId": 1,
                "special: window.parent.getElementById": 1,
                "special: iFrame.contentWindow": 1,
                "special: targetWin.postMessage": 1,
                "special: window.isFirstCall": 3,
                "special: window.EtVal": 4,
                "special: window.EtnVal": 3,
                "special: window.EtRandVal": 3,
                "special: window.AddEtCall": 4,
                "special: query.js": 2,
                "special: com/query": 2,
                "special: document.createElement": 1,
                "special: scriptElem.id": 1,
                "special: scriptElem.type": 1,
                "special: text/javascript": 2,
                "special: scriptElem.src": 1,
                "special: document.body.insertBefore": 1,
                "special: document.body.firstChild": 1,
                "special: window.eCallback": 1,
                "special: b.length": 2,
                "special: a.push": 2,
                "special: String.fromCharCode": 1,
                "special: b.charAt": 2,
                "special: a.join": 2,
                "special: dvObj.registerEventCall": 1,
                "special: dvObj.pubSub.subscribe": 1,
                "special: dc.push": 2,
                "special: dv.getMraid": 1,
                "special: func.call": 2,
                "special: mraidObject.getVendor": 1,
                "special: mraidObject.getVendorVersion": 1,
                "special: dv.CommonData.deviceType": 1,
                "special: dv.CommonData.detectedDeliveryType": 1,
                "special: dv.pubSub.publish": 2,
                "dv_win['dvcallback_1558529198752540']($dv,window,'2d65a8de43154fa8a88ea865c9fff4b5','tps10264.doubleverify.com')": 1,
                "}catch(e){try{var image=window.document.createelement('img')": 1,
                "image.src=window.location.protocol+'//tps30.doubleverify.com/visit.jpg?ctx=818052&cmp=1619415&dvtagver=6.1.src&dvp_cberror='+encodeuricomponent(e.message)}catch(e){}}$dv.pubsub.subscribe('impressionserved', $uid, 'rtn_latencytemp', function () {try {var beforevisitcall = ''": 1,
                "var templatestarttime = parent.getcurrenttime()": 1,
                "if (dv_win && dv_win.t2ttimestampdata) {if (dv_win.t2ttimestampdata.length >= 2) {beforevisitcall = dv_win.t2ttimestampdata[1].beforevisitcall": 1,
                "if (beforevisitcall != '' && templatestarttime != '') {latency = templatestarttime - beforevisitcall": 1,
                "}if(latency > 1000 && latency < 90000) {$dv.registereventcall($uid, { dvp_ltncy: latency })": 1,
                "$dv.pubsub.subscribe ('impressionserved', $uid, 'sendadentitiesforbsbaconsolidation', function() { 'use strict'": 1,
                "var stringifyfunc = null": 1,
                "if(window.json){ stringifyfunc = window.json.stringify": 1,
                "} else { if(window.parent && window.parent.json){ stringifyfunc = window.parent.json.stringify": 1,
                "} } if(!stringifyfunc){ return": 1,
                "} var targetwin": 1,
                "var bsmsg = { action : 'notifybrandshieldadentityinformation', bsadentityinformation : { comparisonitems : [{name : 'cmp', value : 3779693},{name : 'plmt', value : 3779742}], verbosereporting : false } }": 1,
                "var bsstring = stringifyfunc(bsmsg)": 1,
                "var findandsend = function(){ if(!targetwin) { if (tag) { targetwin = tag.t2tiframewindow": 1,
                "if (!targetwin) { var t2tiframeid = tag.t2tiframeid": 1,
                "//get t2t window and post the adentities to it. if (t2tiframeid) { var iframe = window.parent.getelementbyid(t2tiframeid)": 1,
                "if (iframe) { targetwin = iframe.contentwindow": 1,
                "} } } } } if(targetwin){ targetwin.postmessage(bsstring, '*')": 1,
                "findandsend()": 1,
                "settimeout(findandsend, 100)": 1,
                "settimeout(findandsend, 500)": 1,
                "$dv.pubsub.subscribe('impressionserved', $uid, 'rtn_fbitemp', function () {try { window.isfirstcall = true": 1,
                "window.etval = ''": 1,
                "window.etnval = ''": 1,
                "window.etrandval = ''": 1,
                "window.addetcall = function (id) { var queryurl = $dv.tags[$uid].dv_protocol + '/' + '/tps30.doubleverify.com/query.js?ctx=818052&cmp=1239517532'": 1,
                "var scriptelem = document.createelement('script')": 1,
                "scriptelem.id = id": 1,
                "scriptelem.type = 'text/javascript'": 1,
                "scriptelem.src = queryurl": 1,
                "document.body.insertbefore(scriptelem, document.body.firstchild)": 1,
                "window.ecallback = function(et, isetnew, etrand) { if (window.isfirstcall) { window.etval = et": 1,
                "window.etnval = isetnew": 1,
                "window.etrandval = etrand": 1,
                "window.isfirstcall = false": 1,
                "settimeout(function() {window.addetcall('dvet2')": 1,
                "} if(etrand != undefined && etrand === window.etrandval) { settimeout(function() {window.addetcall('dvet' + etrand)": 1,
                "} var isettwice = et == window.etval": 1,
                "$dv.registereventcall($uid, { 'dvp_et':window.etval, 'dvp_etn':window.etnval, 'dvp_ett':(isettwice ? '1' : '0')})": 1,
                "window.addetcall('dvet1')": 1,
                "var dvobj = $dv": 1,
                "c+=2)a.push(string.fromcharcode(parseint(b.charat(c)+b.charat(c+1),32)))": 1,
                "dvobj.registereventcall(g,a,2e3,true)})()}try{d()}catch(f){}}try{dvobj.pubsub.subscribe(dvobj==window.$dv?\"impressionserved\":\"beforedecisionrender\",g,\"np764531\",d)}catch(f){}}": 1,
                "$dv.pubsub.subscribe('impressionserved', $uid, 'operavendorchecker', function(){var eventdata = {}": 1,
                "var mraidobject = $dv.getmraid()": 1,
                "var execmrsaf = function(func) { var rv": 1,
                "try { if (typeof func === 'function') {rv = func.call(mraidobject)} }catch (e) { eventdata = {'dvp_operr': 1} } return rv": 1,
                "try{ if(mraidobject) { var vendor = execmrsaf(mraidobject.getvendor)": 1,
                "var vendor_version = execmrsaf(mraidobject.getvendorversion)": 1,
                "if(vendor != null && vendor_version != null) { eventdata = { dvp_sspv: vendor, dvp_sspvv: vendor_version }": 1,
                "} }}catch (e){ eventdata = { dvp_operr: 2 }": 1,
                "}$dv.registereventcall($uid, eventdata)": 1,
                "$dv.commondata.devicetype = 1": 1,
                "$dv.commondata.detecteddeliverytype = 1": 1,
                "$dv.tags[$uid].devicetype = 1": 1,
                "$dv.tags[$uid].detecteddeliverytype = 1": 1,
                "try{$dv.pubsub.publish('impressionserved', $uid)": 1,
                "$dv.pubsub.publish('impressionserved', $frmid)": 1,
                "special: window.document.createelement": 1,
                "special: dv.pubsub.subscribe": 4,
                "special: parent.getcurrenttime": 1,
                "special: win.t2ttimestampdata": 2,
                "special: win.t2ttimestampdata.length": 1,
                "special: dv.registereventcall": 3,
                "special: window.json": 1,
                "special: window.json.stringify": 1,
                "special: window.parent.json": 1,
                "special: window.parent.json.stringify": 1,
                "special: tag.t2tiframewindow": 1,
                "special: tag.t2tiframeid": 1,
                "special: window.parent.getelementbyid": 1,
                "special: iframe.contentwindow": 1,
                "special: targetwin.postmessage": 1,
                "special: window.isfirstcall": 3,
                "special: window.etval": 4,
                "special: window.etnval": 3,
                "special: window.etrandval": 3,
                "special: window.addetcall": 4,
                "special: document.createelement": 1,
                "special: scriptelem.id": 1,
                "special: scriptelem.type": 1,
                "special: scriptelem.src": 1,
                "special: document.body.insertbefore": 1,
                "special: document.body.firstchild": 1,
                "special: window.ecallback": 1,
                "special: string.fromcharcode": 1,
                "special: b.charat": 2,
                "special: dvobj.registereventcall": 1,
                "special: dvobj.pubsub.subscribe": 1,
                "special: dv.getmraid": 1,
                "special: mraidobject.getvendor": 1,
                "special: mraidobject.getvendorversion": 1,
                "special: dv.commondata.devicetype": 1,
                "special: dv.commondata.detecteddeliverytype": 1,
                "special: dv.pubsub.publish": 2
            }
        },
        {
            "plugin": "extractors.meta",
            "version": "0.1",
            "results": {
                "clamav: Cannot dlopen libclamunrar_iface: file not found - unrar support unavailable": 1,
                "clamav: cli_loadftm: File type signature for Microsoft Windows Shortcut File not loaded (required f-level: 1??)": 1,
                "clamav: [Bytecode JIT]; emitted ELF64-x86-64 <in-memory object> of 7?? bytes": 1,
                "clamav: bytecode self test running": 1,
                "clamav: Bytecode 4?????????: executing in JIT mode": 1,
                "clamav: bytecode finished in 0 us": 1,
                "clamav: bytecode self test succeeded": 1,
                "clamav: [Bytecode JIT]; emitted ELF64-x86-64 <in-memory object> of 1????? bytes": 1,
                "clamav: Bytecode: 94 bytecode prepared with JIT": 1,
                "clamav: Recognized ASCII text": 1,
                "clamav: cli_magic_scandesc: returning 0  at line 2???": 1,
                "clamav: malware family: OK": 1,
                "clamav: OK": 1,
                "clamav: Scanned files: 1": 1,
                "clamav: Infected files: 0": 1,
                "clamav: extracted blobs": 1,
                "clamav: extracted 1 blobs": 1,
                "clamav: blob size: 4???": 1,
                "clamav: Cannot dlopen libclamunrar_iface: file not found - unrar support unavailable;clamav: cli_loadftm: File type signature for Microsoft Windows Shortcut File not loaded (required f-level: 1??)": 1,
                "clamav: cli_loadftm: File type signature for Microsoft Windows Shortcut File not loaded (required f-level: 1??);clamav: [Bytecode JIT]; emitted ELF64-x86-64 <in-memory object> of 7?? bytes": 1,
                "clamav: [Bytecode JIT]; emitted ELF64-x86-64 <in-memory object> of 7?? bytes;clamav: bytecode self test running": 1,
                "clamav: bytecode self test running;clamav: Bytecode 4?????????: executing in JIT mode": 1,
                "clamav: Bytecode 4?????????: executing in JIT mode;clamav: bytecode finished in 0 us": 1,
                "clamav: bytecode finished in 0 us;clamav: bytecode self test succeeded": 1,
                "clamav: bytecode self test succeeded;clamav: [Bytecode JIT]; emitted ELF64-x86-64 <in-memory object> of 1????? bytes": 1,
                "clamav: [Bytecode JIT]; emitted ELF64-x86-64 <in-memory object> of 1????? bytes;clamav: Bytecode: 94 bytecode prepared with JIT": 1,
                "clamav: Bytecode: 94 bytecode prepared with JIT;clamav: Recognized ASCII text": 1,
                "clamav: Recognized ASCII text;clamav: cli_magic_scandesc: returning 0  at line 2???": 1,
                "clamav: cli_magic_scandesc: returning 0  at line 2???;clamav: malware family: OK": 1,
                "clamav: malware family: OK;clamav: OK": 1,
                "clamav: OK;clamav: Scanned files: 1": 1,
                "clamav: Scanned files: 1;clamav: Infected files: 0": 1,
                "clamav: Infected files: 0;clamav: extracted blobs": 1,
                "clamav: extracted blobs;clamav: extracted 1 blobs": 1,
                "clamav: extracted 1 blobs;clamav: blob size: 4???": 1,
                "File type: ASCII text, with very long lines, with CRLF, LF line terminators": 1,
                "File type segment: ASCII text": 1,
                "File type word: ASCII": 1,
                "File type word: text": 1,
                "File type segment:  with very long lines": 1,
                "File type word: with": 2,
                "File type word: very": 1,
                "File type word: long": 1,
                "File type word: lines": 1,
                "File type segment:  with CRLF": 1,
                "File type word: CRLF": 1,
                "File type segment:  LF line terminators": 1,
                "File type word: LF": 1,
                "File type word: line": 1,
                "File type word: terminators": 1,
                "Extracted blob: ASCII text, with very long lines, with no line terminators": 1,
                "blob file types: ASCII": 1
            }
        }
    ]
}