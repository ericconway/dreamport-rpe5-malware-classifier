define("meoffice",["jquery","jqbehavior","mediator","refreshmodules","headdata","webstorage","window"],function(n,t,i,r,u,f,e){function o(t,o){function v(n){var r=e.localstorage,i,t,u;if(r&&r.deferloadeditems)for(i=r.deferloadeditems.split(","),t=0,u=i.length;t<u;t++)if(i[t]&&i[t].indexof(n)!==-1){f.removeitem(i[t]);break}}function a(){var i=t.find("section li time");i.each(function(){var t=new date(n(this).attr("datetime"));t&&n(this).html(t.tolocalestring())})}function p(){c=t.find("[data-module-id]").eq(0);c.length&&(h=c.data("moduleid"),h&&(l="modulerefreshed-"+h,i.sub(l,a)))}function y(){i.unsub(o.eventname,y);r(s).done(function(){a();p()})}var s,c,h,l;return u.signedin||(t.hasclass("office")?v("meoffice"):t.hasclass("onenote")&&v("meonenote")),{setup:function(){s=t.find("[data-module-deferred-hover], [data-module-deferred]").not("[data-sso-dependent]");s.length&&s.data("module-deferred-hover")&&s.html("<p class='meloading'><\/p>");i.sub(o.eventname,y)},teardown:function(){h&&i.unsub(l,a)}}}return t(o)});require(["binding","c.deferred"],function(n){var t="html";n("meoffice",".meflyouts .office",t).all({eventname:"officeflyoutvisible"});n("meoffice",".meflyouts .onenote",t).all({eventname:"onenoteflyoutvisible"})})