var ipv6tests;(function(n){function c(t){var r,c,o,l,f,s,i,a,v;try{if(y(),t==null||t.length==0)return;if(r=sj_cook.get(n.ipv6testcookie,n.ipv6testcrumb),r!=null&&r=="1"&&!u)return;if(c=sj_cook.get(n.ipv6testcookie,n.iptypecrumb),r!=null&&c&&u&&(o=number(r),l=(new date).gettime(),o!=nan&&o>l))return;if(f=_d.getelementsbytagname("head")[0],!f)return;if(s="ipv6testscript"+t,i=sj_ce("script",s),i.type="text/javascript",i.async=!0,i.onerror=function(){log.log("ipv6test","ipv6test dom_ "+t,"ipv6testerror",!1,"error","jsonp call resulted in error.")},a=_ge(s),a&&f)return;f.insertbefore(i,f.firstchild);i.setattribute("src",_w.location.protocol+"//"+t+".bing.com/ipv6test/test");e&&p();v=u?(new date).gettime()+h:"1";sj_cook.set(n.ipv6testcookie,n.ipv6testcrumb,v.tostring(),!1)}catch(w){log.log("ipv6test","dom_ "+t,"ipv6testerror",!1,"error","failed to make jsonp call. exception - "+w.message)}}function l(t){if(!t){log.log("ipv6test","ipv6testresponseerror","ipv6testerror",!1,"error","got null response from endpoint.");return}try{var i=json.parse(a(t)),r=i&&i.type?i.type:"0";f=="6"&&(r=f);sj_cook.set(n.ipv6testcookie,n.iptypecrumb,r,!1)}catch(u){log.log("ipv6test","ipv6responseerror","ipv6testerror",!1,"error","failed to parse response. exception - "+u.message)}}function a(n){var t=sj_ce("textarea");return t.innerhtml=n,t.value}function v(){o?n.pingserver(r):_d.body.addeventlistener&&(_d.body.addeventlistener("domnodeinserted",i),_d.body.addeventlistener("domnoderemoved",i))}function y(){_d.body.removeeventlistener&&(_d.body.removeeventlistener("domnodeinserted",i),_d.body.removeeventlistener("domnoderemoved",i))}function i(){try{t!=null&&(clearinterval(t),t=null);t=settimeout(function(){n.pingserver(r)},1e3)}catch(i){log.log("ipv6test","ipv6testpingerror","ipv6testerror",!1,"error","exception initiating ping-"+i.message)}}function p(){var n=new xmlhttprequest;n.open("get","/ipv6test/test?form=monitr",!0);n.overridemimetype&&n.overridemimetype("text/plain");n.send()}function w(t,i,u){t!=null&&t==="6"&&(r=s,f=t);typeof i=="boolean"&&(e=i);typeof u=="boolean"&&(o=u);try{sj_evt.bind("onp1",n.observedomchanges,!0)}catch(h){log.log("ipv6test","ipv6testbinderror","ipv6testerror",!1,"error","exception binding onp1 - "+h.message)}}n.ipv6testcookie="ipv6";n.ipv6testcrumb="hit";n.iptypecrumb="t";var t,s="4",r="www2",u=!0,h=36e5,f="4",e=!1,o=!1;n.pingserver=c;n.testipv6response=l;n.observedomchanges=v;n.init=w})(ipv6tests||(ipv6tests={})),function(){try{typeof ipd!="undefined"&&ipd!=null&&ipv6tests.init(ipd.ipt,ipd.secall,ipd.pd)}catch(n){log.log("ipv6test","ipv6testiniterror","ipv6testerror",!1,"error","exception calling init method - "+n.message)}}()